--JOIN 실습 1번
SELECT TO_CHAR(TO_DATE('20/12/25'), 'DAY') FROM DUAL;

--JOIN 실습 2번
SELECT E.EMP_NAME AS 사원명,
E.EMP_NO AS 주민번호,
D.DEPT_TITLE AS 부서명,
J.JOB_NAME AS 직급명 FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPT_CODE = D.DEPT_ID
JOIN JOB J ON E.JOB_CODE = J.JOB_CODE
WHERE (SUBSTR(E.EMP_NO,1,2) BETWEEN 70 AND 79)
AND SUBSTR(E.EMP_NO,8,1) = 2
AND E.EMP_NAME LIKE '전%';

--JOIN 실습 3번
SELECT E.EMP_ID,
E.EMP_NAME AS 사원명,
D.DEPT_TITLE AS 부서명
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPT_CODE = D.DEPT_ID
WHERE E.EMP_NAME LIKE '%형%';

--JOIN 실습 4번
SELECT E.EMP_NAME AS 사원명,
J.JOB_NAME AS 직급명,
E.DEPT_CODE AS 부서코드,
D.DEPT_TITLE AS 부서명
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPT_CODE = D.DEPT_ID
JOIN JOB J ON E.JOB_CODE = J.JOB_CODE
WHERE D.DEPT_TITLE LIKE '해외영업%';

--JOIN 실습 5번
SELECT E.EMP_NAME AS 사원명,
E.BONUS,
D.DEPT_TITLE AS 부서명,
L.LOCAL_NAME
FROM EMPLOYEE E
LEFT JOIN DEPARTMENT D ON E.DEPT_CODE = D.DEPT_ID
LEFT JOIN LOCATION L ON D.LOCATION_ID = L.LOCAL_CODE
WHERE E.BONUS IS NOT NULL;

--JOIN 실습 6번
SELECT E.EMP_NAME AS 사원명,
J.JOB_NAME,
D.DEPT_TITLE AS 부서명,
L.LOCAL_NAME
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPT_CODE = D.DEPT_ID
JOIN JOB J ON E.JOB_CODE = J.JOB_CODE
JOIN LOCATION L ON D.LOCATION_ID = L.LOCAL_CODE
WHERE E.DEPT_CODE = 'D2';

SELECT * FROM EMPLOYEE;
--JOIN 실습 7번
SELECT E.EMP_NAME AS 이름,
J.JOB_NAME, 
LTRIM(TO_CHAR(E.SALARY, 'L999,999,999')) AS 급여,
LTRIM(TO_CHAR(S.MAX_SAL-200000, 'L999,999,999')) AS "조정된 최대급여(-20만)"
FROM EMPLOYEE E
JOIN JOB J ON E.JOB_CODE = J.JOB_CODE
JOIN SAL_GRADE S ON E.SAL_LEVEL = S.SAL_LEVEL
WHERE E.SALARY > S.MAX_SAL-200000
ORDER BY SALARY DESC;

--JOIN 실습 8번
SELECT E.EMP_NAME AS 사원명,
D.DEPT_TITLE AS 부서명,
L.LOCAL_NAME AS 지역명,
DECODE(L.NATIONAL_CODE,'KO','한국','JP','일본') AS 국가명
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DEPT_CODE = D.DEPT_ID
JOIN LOCATION L ON D.LOCATION_ID = L.LOCAL_CODE
WHERE L.NATIONAL_CODE IN ('KO','JP');

--JOIN 실습 9번
SELECT E1.EMP_NAME AS "사원명",
D.DEPT_TITLE, 
E2.EMP_NAME AS "동로이름"
FROM EMPLOYEE E1 
JOIN EMPLOYEE E2 ON E1.DEPT_CODE = E2.DEPT_CODE
JOIN DEPARTMENT D ON E1.DEPT_CODE = D.DEPT_ID
WHERE E1.EMP_NAME <> E2.EMP_NAME
ORDER BY E1.EMP_NAME;

--JOIN 실습 10번
SELECT E.EMP_NAME AS 사원명,
J.JOB_NAME,
SALARY
FROM EMPLOYEE E
JOIN JOB J ON E.JOB_CODE = J.JOB_CODE
WHERE BONUS IS NULL AND
J.JOB_NAME IN ('사원', '차장');

--JOIN 실습 11번
SELECT DECODE(ENT_YN,'Y','퇴사','N','재직') AS "재직 여부",
COUNT(*) AS "인원 수"
FROM EMPLOYEE
GROUP BY ENT_YN;